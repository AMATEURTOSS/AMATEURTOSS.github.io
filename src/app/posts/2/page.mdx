# 홈서버 구축기

어느날 문득 그런 생각이 들었습니다.

> 명색이 개발자면 홈서버 하나정도는 있어야하는 것 아닌가..?

사실 문득 든 생각은 아니고 옛날부터 하나쯤 가지고 싶었는데 한번 저질러봤습니다.

지금 데스크탑으로 조립 컴퓨터를 사용하고는 있지만,
견적을 업체에 맡겼던 만큼 실제로 컴퓨터를 부품 호환성부터 챙겨가면서 구매하고 조립해 본 일은 처음이였습니다.

그래서 우여곡절도 많았는데요,
지금부터 무슨 일이 있었는지 좀 소개해 드리겠습니다.

## NAS를 선택하지 않은 이유

**홈서버** 구축을 생각하면 많은 분들이 첫 옵션으로 생각하는 것이 NAS입니다.

NAS는 기본적으로 완제품 형식으로 나오기도하고,
OS에서 포트포워딩이나 DNS 같은 네트워크 설정이 없더라도 밖에서 접근할 수 있도록 프록시같은 것을 지원해줘서 (실제로 구현이 어떻게 되어있는지는 모르겠지만) 상당히 편한 것이 장점입니다.

그래서 가장 잘팔리는 NAS의 스펙을 한번 구경해봤습니다.

Synology사의 [DS224+](https://www.synology.com/ko-kr/products/DS224+#features) 라는 제품인데요,
글 작성시 다나와 기준 489,000 정도하는 NAS입니다.

![DS224+ 스펙 표](/2/1.png)

저는 이 스펙을 보고 가격대비 너무 처참하지 않나..? 싶었습니다.

50만원 가까이 하는 기계인데도 4코어 2GHz, 2기가 메모리는 좀…

그리고 제가 홈서버를 구축하는 이유는 사실 가지고 놀려고 하는건데 이런 스펙이면 마인크래프트 서버도 제대로 못돌릴 것 같다 라는 생각이 들었습니다.

사진, 동영상 등을 많이 저장해야하는 니즈가 있었더라면 NAS도 고민해봤겠지만,
저는 사진을 찍고다니는 성격은 아니라 NAS는 홈서버로 부적합하다고 생각했습니다.

## 그러다 발견한 Xeon CPU

조립 서버를 고민하다가 알리익스프레스를 처음 접하게 됐는데,
오래된 서버 CPU를 엄청 싸게 파는 것을 봤습니다.
제가 봤던건 Xeon E5 2680 V4 모델인데, 구입 당시 3만원 초반대로 구할 수 있는데도 불구하고 2022년에 출시된 13만원짜리 Ryzen 5 5500 CPU와 [성능이 비슷](https://technical.city/en/cpu/Xeon-E5-2680-v4-vs-Ryzen-5-5500)해서 놀랐습니다.

가성비가 좋아 이걸로 서버를 구성하면 NAS를 구매하는것보다 훨씬 나을 것 같아 Xeon CPU로 서버를 직접 만들기로 결심했습니다.

## 부품 구매

| 분류           | 제품명                                                 |
|--------------|-----------------------------------------------------|
| CPU          | Intel Xeon E5 2680 V4 * 2                           |
| Mother Board | MACHINIST X99 듀얼 CPU 마더보드                           |
| RAM          | 삼성전자 DDR4 16GB PC4-25600                            |
| Storage      | 삼성전자 PM9A1 512GB (m.2 ssd)                          |
| VGA          | NVIDIA GT730                                        |
| Power        | 마이크로닉스 Classic II 풀체인지 600W 80PLUS BRONZE ATX3.1 파워 |

위 구성으로 알리익스프레스에 주문을 넣고 설레는 마음으로 기다렸습니다.

## 파워 호환 문제

CPU가 3만원대로 생각보다 싸서 듀얼 CPU 구성으로 진행을 했습니다.

여기서 문제가 발생했는데,
제가 구입한 파워는 CPU 선이 한개짜리여서 선을 두개 꼽아야하는 MACHINIST 듀얼 마더보드와는 호환이 안됐습니다.

그래서 기존 파워를 죄송하지만 환불받고 CPU 선이 두개인 `Seasonic A12 Standard 230V EU SSR-700RA LLC` 파워를 구입했습니다.

## BIOS 화면이 안뜨는 문제

마더보드에 CPU, RAM, SSD, VGA, POWER를 다 끼고 부팅을 시도하는데,
메인보드에 b7 내지는 67 에러코드가 발생하면서 재부팅을 계속 시도하는 버그가 발생했습니다.

![67 에러코드](/2/2.png)

구글에 검색해보니 마더보드 67코드는 [램 관련 오류](https://forums.evga.com/Post-code-67-m2287093.aspx)라는 정보가 있어서 제 데스크탑에 있는 멀쩡한 램으로 테스트 해봤습니다.
그런데도 상황이 동일하자 저는 아래와 같은 가설을 세웠습니다.

1. CPU의 메모리 인식하는 부분이 고장난 것
2. 메인보드의 메모리 슬롯이 고장난 것

가설을 세워보고 생각해보니 CPU가 좀 이상했던 것 같았습니다.
배송이 왔을 때 부터 살짝 그슬려져있었기도 했고, 칩에 하얀색 부식같은게 보였기 때문입니다.

![하얀색 부식이 보이는 CPU](/2/3.png)

그래서 칩 안쪽의 하얀 부식을 커터칼로 긁어내보기도 했는데 상황이 변하지는 않았습니다.

어떻게 해야하나 고민하다가 구글에서 MACHINIST 메인보드 [메뉴얼](https://manuals.plus/machinist/x99-dual-cpu-motherboard-manual)을 발견해서 혹시나 하는 마음에 읽어보았습니다.
그런데 메뉴얼에 아래와 같은 문구가 적혀있었습니다.

> The motherboard provides 8 DDR4 ECC DIMM slots with a maximum capacity of 256GB.

이 문구를 보고 내 메모리가 ECC가 아니였구나 깨달았고, 새 램을 구매해서 문제를 해결했습니다.

## 스펙

이런 우여곡절 끝에 홈서버 구축을 마쳤는데, 최종 스펙은 아래와 같습니다.

| 분류           | 제품명                                         |
|--------------|---------------------------------------------|
| CPU          | Intel Xeon E5 2680 V4 * 2                   |
| Mother Board | MACHINIST X99 듀얼 CPU 마더보드                   |
| RAM          | 삼성전자 16GB DDR4 2400MHz PC4-19200 ECC/REG    |
| Storage      | 삼성전자 PM9A1 512GB (m.2 ssd)                  |
| VGA          | NVIDIA GT730                                |
| Power        | Seasonic A12 Standard 230V EU SSR-700RA LLC |

## 벤치마크 결과

![벤치마크결과표 싱글코어1167점, 멀티코어 5324점](/2/4.png)

[GeekBench](https://browser.geekbench.com/v6/cpu/7633155)

역시 싸고 좋은건 없는걸까요… 사실 생각했던것보다는 성능이 많이 낮았습니다.
그래도 가격이 50만원정도라고 생각하면 봐줄만 한 것 같습니다.

## 맺음말

개발자임에도 불구하고 하드웨어적인 지식은 많이 부족했는데 이번에 부품호환성 맞추느라고 X86_64, AMD64, ARM, ECC, DRAM 등등 여러가지 용어를 알게되어 꽤 유익했던 시간인 것 같습니다.
이제 이걸 어디다 쓸 지 고민해봐야겠네요.
글 읽어주셔서 감사합니다.
